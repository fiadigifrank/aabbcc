
[General]
# --- GENERAL ---
# Enhanced Wi-Fi Assist
wifi-assist = false
# Hybrid Network
all-hybrid = true

# Latency Benchmark
internet-test-url = http://g.alicdn.com/generate_204
proxy-test-url = http://cp.cloudflare.com/generate_204
test-timeout = 5

# GeoIP Database
geoip-maxmind-url = https://raw.githubusercontent.com/Loyalsoldier/geoip/release/Country.mmdb

# IPv6 Support
ipv6 = true

# --- Wi-Fi ACCESS ---
//è‹¥å…è®¸è¿œç¨‹è®¿é—®å°† <false> æ”¹ä¸º <true>,ä»… iOS
allow-wifi-access = false
allow-hotspot-access = true //æ— é™çƒ­ç‚¹ä»£ç†
wifi-access-http-port = 6152
wifi-access-socks5-port = 6153

//è‹¥å…è®¸è¿œç¨‹è®¿é—®å°† <127.0.0.1> æ”¹ä¸º <0.0.0.0>,ä»… macOS
http-listen = 127.0.0.1:6152
socks5-listen = 127.0.0.1:6153

# --- REMOTE CONTROLLER ---
# Remote Controller
external-controller-access = key@127.0.0.1:8888

# HTTP API & Web Dashboard
//This option allows using HTTP APIs to control
http-api = key@0.0.0.0:6166
//ä½¿ç”¨ HTTPS æ›¿ä»£ HTTP åè®®ï¼Œéœ€è¦å…ˆé…ç½® MitM çš„ CA è¯ä¹¦ï¼ŒåŒæ—¶éœ€è¦åœ¨å®¢æˆ·ç«¯è®¾å¤‡ä¸Šæ‰‹åŠ¨å®‰è£…å¹¶ä¿¡ä»» CA è¯ä¹¦ã€‚
http-api-tls = false
//å¼€å¯è¯¥é€‰é¡¹åå¯ä»¥é€šè¿‡æµè§ˆå™¨æ§åˆ¶ Surgeï¼Œæœ¬æœºæµè§ˆå™¨è¾“å…¥127.0.0.1:6166
http-api-web-dashboard = true

# --- COMPATIBILITY ---
# å…¼å®¹æ¨¡å¼
compatibility-mode = False
# è·³è¿‡ä»£ç†
skip-proxy = 127.0.0.1, 192.168.0.0/16, 10.0.0.0/8, 172.16.0.0/12, 100.64.0.0/10, passenger.t3go.cn, localhost, *.local
# æ’é™¤ç®€å•ä¸»æœºå
exclude-simple-hostnames = true

# --- DNS ---
# The IP addresses of upstream DNS servers
dns-server = 223.5.5.5, 119.29.29.29, 8.8.8.8, system
# ä» /etc/hosts è¯»å– DNS è®°å½•
read-etc-hosts = true
# The URL of the DNS-over-HTTPS server
//doh-server = https://doh.pub/dns-query //DNSPod
# DoH è¯·æ±‚é€šè¿‡ä»£ç†ç­–ç•¥æ‰§è¡Œ
doh-follow-outbound-mode = false

# --- ROUTING ---
# åŒ…å«æ‰€æœ‰ç½‘ç»œè¯·æ±‚
include-all-networks = false
# åŒ…å«æœ¬åœ°ç½‘ç»œè¯·æ±‚
include-local-networks = false

# --- ADVANCED ---
# Log Level
loglevel = notify
# å½“é‡åˆ° REJECT ç­–ç•¥æ—¶è¿”å›é”™è¯¯é¡µ
show-error-page-for-reject = true
# Always Real IP Hosts
always-real-ip = link-ip.nextdns.io, *.msftconnecttest.com, *.msftncsi.com, *.srv.nintendo.net, *.stun.playstation.net, xbox.*.microsoft.com, *.xboxlive.com, *.logon.battlenet.com.cn, *.logon.battle.net, stun.l.google.com
# Hijack DNS
hijack-dns = 8.8.8.8:53, 8.8.4.4:53
# TCP Force HTTP Hosts
force-http-engine-hosts = *.ott.cibntv.net, 123.59.31.1,119.18.193.135, 122.14.246.33, 175.102.178.52, 116.253.24.*, 175.6.26.*, 220.169.153.*
# VIF Excluded Routes
//tun-excluded-routes = 239.255.255.250/32
# VIF Included Routes
//tun-included-routes = 192.168.1.12/32
# å½“ Wi-Fi ä¸æ˜¯é¦–é€‰ç½‘ç»œæ—¶ SSID ç»„ç­–ç•¥ä½¿ç”¨é»˜è®¤ç­–ç•¥
use-default-policy-if-wifi-not-primary = false

# æ§åˆ¶å½“ UDP æµé‡è¢«åŒ¹é…åˆ°ä¸€ä¸ªä¸æ”¯æŒ UDP è½¬å‘çš„ç­–ç•¥æ—¶çš„è¡Œä¸º
#   - DIRECTï¼šå›é€€åˆ° DIRECT ç­–ç•¥ï¼ˆé»˜è®¤ï¼‰
#   - REJECTï¼šå›é€€åˆ° REJECT ç­–ç•¥
udp-policy-not-supported-behaviour = REJECT

[Replica]
# æŠ“å–æµé‡ => è¿‡æ»¤å™¨ 1ä¸ºå¼€å¯ï¼Œ0ä¸ºå…³é—­
# éšè— Apple è¯·æ±‚
hide-apple-request = 1
# éšè— Crashlytics è¯·æ±‚
hide-crash-reporter-request = 1
# éšè— UDP ä¼šè¯
hide-udp = 1
# å…³é”®è¯è¿‡æ»¤å™¨
//noneï¼ˆå…³é—­å…³é”®è¯è¿‡æ»¤å™¨ï¼‰ / whitelistï¼ˆä»…è®°å½•åŒ…å«å…³é”®è¯çš„è¯·æ±‚ï¼‰ / blacklistï¼ˆä»…è®°å½•ä¸åŒ…å«å…³é”®è¯çš„è¯·æ±‚ï¼‰ / patternï¼ˆè®°å½•åŒ¹é…é€šé…ç¬¦çš„è¯·æ±‚ï¼‰
keyword-filter-type = blacklist
keyword-filter = icloud, ocsp, logs, analytic, imap, adthor, applovin, appnext, talk, dropbox, github, spys, nexdns, 149.154, 91.108

[Proxy]
ğŸŒ Direct = direct

[Proxy Group]
# > ç­–ç•¥ç»„ï¼ˆä¸‹é¢çš„èŠ‚ç‚¹ä¿¡æ¯éœ€ä¸å¤–éƒ¨èŠ‚ç‚¹å¯¹åº”ï¼Œè‹¥åˆ é™¤äº†å¤–éƒ¨èŠ‚ç‚¹é‡Œçš„èŠ‚ç‚¹ï¼Œé‚£ä¹ˆåœ¨ç­–ç•¥ç»„é‡Œä¹Ÿè¦åˆ é™¤ã€‚ï¼‰
â™»ï¸ Manual = select, ğŸ‡¹ğŸ‡¼ TW, ğŸ‡ºğŸ‡² US, ğŸ‡¯ğŸ‡µ JP, ğŸ‡¸ğŸ‡¬ SG, ğŸ‡°ğŸ‡· KR, ğŸ± Other, ğŸš€ Manual, ğŸŒ Direct
ğŸ›° Proxy = select, â™»ï¸ Manual, ğŸ‡¹ğŸ‡¼ TW, ğŸ‡ºğŸ‡² US, ğŸ‡¯ğŸ‡µ JP, ğŸ‡¸ğŸ‡¬ SG, ğŸ‡°ğŸ‡· KR, ğŸ± Other, ğŸš€ Manual, ğŸŒ Direct
ğŸ Streaming = select, â™»ï¸ Manual, ğŸ‡¹ğŸ‡¼ TW, ğŸ‡ºğŸ‡² US, ğŸ‡¯ğŸ‡µ JP, ğŸ‡¸ğŸ‡¬ SG, ğŸ‡°ğŸ‡· KR, ğŸ± Other, ğŸš€ Manual, ğŸŒ Direct
ğŸ“§ Telegram = select, â™»ï¸ Manual, ğŸ‡¹ğŸ‡¼ TW, ğŸ‡ºğŸ‡² US, ğŸ‡¯ğŸ‡µ JP, ğŸ‡¸ğŸ‡¬ SG, ğŸ‡°ğŸ‡· KR, ğŸ± Other, ğŸš€ Manual, ğŸŒ Direct
â˜˜ï¸ Line = select, â™»ï¸ Manual, ğŸ‡¹ğŸ‡¼ TW, ğŸ‡ºğŸ‡² US, ğŸ‡¯ğŸ‡µ JP, ğŸ‡¸ğŸ‡¬ SG, ğŸ‡°ğŸ‡· KR, ğŸ± Other, ğŸš€ Manual, ğŸŒ Direct
ğŸ§ Spotify = select, â™»ï¸ Manual, ğŸ‡¹ğŸ‡¼ TW, ğŸ‡ºğŸ‡² US, ğŸ‡¯ğŸ‡µ JP, ğŸ‡¸ğŸ‡¬ SG, ğŸ‡°ğŸ‡· KR, ğŸ± Other, ğŸš€ Manual, ğŸŒ Direct
ğŸ¥ Netflix = select, â™»ï¸ Manual, ğŸ‡¹ğŸ‡¼ TW, ğŸ‡ºğŸ‡² US, ğŸ‡¯ğŸ‡µ JP, ğŸ‡¸ğŸ‡¬ SG, ğŸ‡°ğŸ‡· KR, ğŸ± Other, ğŸš€ Manual, ğŸŒ Direct
ğŸ Apple = select, â™»ï¸ Manual, ğŸ‡¹ğŸ‡¼ TW, ğŸ‡ºğŸ‡² US, ğŸ‡¯ğŸ‡µ JP, ğŸ‡¸ğŸ‡¬ SG, ğŸ‡°ğŸ‡· KR, ğŸ± Other, ğŸš€ Manual, ğŸŒ Direct
ğŸ§© Microsoft = select, â™»ï¸ Manual, ğŸ‡¹ğŸ‡¼ TW, ğŸ‡ºğŸ‡² US, ğŸ‡¯ğŸ‡µ JP, ğŸ‡¸ğŸ‡¬ SG, ğŸ‡°ğŸ‡· KR, ğŸ± Other, ğŸš€ Manual, ğŸŒ Direct
ğŸ‡¨ğŸ‡³ Domestic = select, â™»ï¸ Manual, ğŸ‡¹ğŸ‡¼ TW, ğŸ‡ºğŸ‡² US, ğŸ‡¯ğŸ‡µ JP, ğŸ‡¸ğŸ‡¬ SG, ğŸ‡°ğŸ‡· KR, ğŸ± Other, ğŸš€ Manual, ğŸŒ Direct
ğŸŸ Final = select, â™»ï¸ Manual, ğŸ‡¹ğŸ‡¼ TW, ğŸ‡ºğŸ‡² US, ğŸ‡¯ğŸ‡µ JP, ğŸ‡¸ğŸ‡¬ SG, ğŸ‡°ğŸ‡· KR, ğŸ± Other, ğŸš€ Manual, ğŸŒ Direct

# > å¤–éƒ¨èŠ‚ç‚¹
#ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹ = fallback, policy-path=è®¢é˜…åœ°å€, update-interval=0, policy-regex-filter=æ¸¯|ğŸ‡­ğŸ‡°|Hong
ğŸ‡¹ğŸ‡¼ TW = fallback, policy-path=https://sub.store/download/collection/WWNCloud, update-interval=0, policy-regex-filter=å°|ğŸ‡¹ğŸ‡¼|æ–°åŒ—|æ¡ƒå›­|æ–°ç«¹|å½°åŒ–|é«˜é›„|TW|Hinet|HINET|Taiwan, interval=600, tolerance=100, evaluate-before-use=true
ğŸ‡ºğŸ‡² US = fallback, policy-path=https://sub.store/download/collection/WWNCloud, update-interval=0, policy-regex-filter=ç¾|ğŸ‡ºğŸ‡¸|US, interval=600, tolerance=100, evaluate-before-use=true
ğŸ‡¯ğŸ‡µ JP = fallback, policy-path=https://sub.store/download/collection/WWNCloud, update-interval=0, policy-regex-filter=æ—¥|ğŸ‡¯ğŸ‡µ|JP, interval=600, tolerance=100, evaluate-before-use=true
ğŸ‡¸ğŸ‡¬ SG = fallback, policy-path=https://sub.store/download/collection/WWNCloud, update-interval=0, policy-regex-filter=æ–°|ğŸ‡¸ğŸ‡¬|SG, interval=600, tolerance=100, evaluate-before-use=true
ğŸ‡°ğŸ‡· KR = fallback, Policy-path=https://sub.store/download/collection/WWNCloud, update-interval=0, policy-regex-filter=ğŸ‡°ğŸ‡·|KR|Korea|KOR|é¦–å°”|éŸ©|éŸ“|æ˜¥å·, interval=600, tolerance=100, evaluate-before-use=true
ğŸ± Other = select, Policy-path=https://sub.store/download/collection/WWNCloud, update-interval=0, policy-regex-filter=ğŸ‡©ğŸ‡ª|ğŸ‡¬ğŸ‡§|ğŸ‡¹ğŸ‡·|ğŸ‡µğŸ‡­|ğŸ‡¦ğŸ‡º|ğŸ‡«ğŸ‡·|ğŸ‡®ğŸ‡³|ğŸ‡¨ğŸ‡¦|ğŸ‡·ğŸ‡º|ğŸ‡§ğŸ‡·|ğŸ‡²ğŸ‡¾|ğŸ‡³ğŸ‡±|ğŸ‡¦ğŸ‡ª|ğŸ‡¿ğŸ‡¦, interval=600, tolerance=100, evaluate-before-use=true
ğŸš€ Manual = select, policy-path=https://sub.store/download/collection/WWNCloud update-interval=0, no-alert=0, include-all-proxies=0, interval=600, tolerance=100, evaluate-before-use=true

[Rule]
# --- CUSTOM RULES ---
# æ–°å¢å†…ç½®ç­–ç•¥ NO-HYBRIDï¼Œç­‰ä»·ä¸º NO-HYBRID = direct, hybrid=off
DOMAIN-SUFFIX,cmbchina.com,NO-HYBRID // éƒ¨åˆ†æœåŠ¡ä¼šæ ¡éªŒè¯·æ±‚çš„æ¥æº IPï¼Œåœ¨å¼€å¯ hybrid æ—¶æœ‰å¯èƒ½å› ä¸ºè¯·æ±‚IPå˜åŒ–å¯¼è‡´æ— æ³•æ­£å¸¸ç™»å½•å’Œä½¿ç”¨ï¼ˆå¦‚æ‹›å•†é“¶è¡Œï¼‰ï¼Œå¯ä½¿ç”¨ NO-HYBRID å¯¹ç‰¹å®šè¯·æ±‚å•ç‹¬å…³é—­ All Hybrid
# HTTP3/QUIC åè®®åŸºäº UDPï¼Œéƒ¨åˆ†åœ°åŒº ISP æˆ–çº¿è·¯ UDP å®¹æ˜“å—åˆ°å¹²æ‰°æˆ–é™é€Ÿï¼Œå±è”½æ‰ä»¥é˜»æ­¢ HTTP 3 æµé‡çš„ UDP æµé‡ï¼Œå¼ºåˆ¶å›é€€åˆ° TCPã€‚
# REJECT-NO-DROP è¡¨ç¤ºä¸ä½¿ç”¨é»˜è®¤çš„è‡ªåŠ¨ä¸¢åŒ…é€»è¾‘ï¼Œè¿™æ · Surge æ¯æ¬¡éƒ½ä¼šè¿”å› ICMP Port Unreachableï¼Œåº”ç”¨ä¼šç«‹åˆ»å›é€€è€Œä¸æ˜¯ç­‰è¶…æ—¶ã€‚
AND,((PROTOCOL,UDP),(DEST-PORT,443)),REJECT-NO-DROP
# Download
PROCESS-NAME,aria2c,ğŸŒ Direct
PROCESS-NAME,fdm,ğŸŒ Direct
PROCESS-NAME,Folx,ğŸŒ Direct
PROCESS-NAME,NetTransport,ğŸŒ Direct
PROCESS-NAME,Thunder,ğŸŒ Direct
PROCESS-NAME,Transmission,ğŸŒ Direct
PROCESS-NAME,uTorrent,ğŸŒ Direct
PROCESS-NAME,WebTorrent,ğŸŒ Direct
PROCESS-NAME,WebTorrent Helper,ğŸŒ Direct

# External Resources Update
AND,((DOMAIN,raw.githubusercontent.com), (DOMAIN-SUFFIX,github.io), (USER-AGENT,Surge/*)),FINAL,notification-text="â™»ï¸External Resources Update",notification-interval=3600
# Blocking UDP Packets by Youtube and ins
AND,((DOMAIN-SUFFIX,googlevideo.com), (DOMAIN-SUFFIX,gvt1.com), (DOMAIN-SUFFIX,cdninstagram.com), (PROTOCOL,UDP)),REJECT
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Telegram/Telegram.list,ğŸ“§ Telegram
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/TelegramSG/TelegramSG.list,ğŸ‡¸ğŸ‡¬ SG
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/TelegramUS/TelegramUS.list,ğŸ‡ºğŸ‡² US
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Naver/Naver.list,â˜˜ï¸ Line
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Spotify/Spotify.list,ğŸ§ Spotify
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Microsoft/Microsoft.list,ğŸ§© Microsof
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Apple/Apple.list,ğŸ Apple
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Global/Global.list,ğŸ Streaming
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/TeamViewer/TeamViewer.list,ğŸ›° Proxy
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Global/Global.list,ğŸ›° Proxy
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/China.list,ğŸ‡¨ğŸ‡³ Domestic
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Unbreak.list,ğŸ›° Proxy
GEOIP,CN,ğŸ‡¨ğŸ‡³ Domestic
FINAL,ğŸŸ Final,dns-failed

[MITM]
skip-server-cert-verify = true
hostname = www.google.cn, api.abema.io, *.zhihu.com, -CUSTOMMitM

[Panel]
flushDNS = script-name=flushDNS,update-interval=-1

[Script]
# Flush DNS, show the DNS delay and server.
flushDNS = type=generic,timeout=10,script-path=https://raw.githubusercontent.com/zZPiglet/Task/master/asset/flushDNS.js,argument=icon=wand.and.stars.inverse&color=#3d3d5b