load_module modules/ngx_stream_module.so;
events {
    use epoll;
    worker_connections 512;
    multi_accept on;
}

stream {
    server {
        listen              443 ssl; 
        listen            48001 ssl;      # 设置监听端口为443&22053

        ssl_protocols      TLSv1.2 TLSv1.3;      # 设置使用的SSL协议版本

        ssl_certificate /etc/nginx/cert/bpg-nd-cc-ora-6899.spdio.xyz/fullchain.pem; # 证书地址
        ssl_certificate_key /etc/nginx/cert/bpg-nd-cc-ora-6899.spdio.xyz/key.key; # 秘钥地址
        ssl_session_cache   shared:SSL:10m;             # SSL TCP会话缓存设置共享内存区域名为
                                                        # SSL，区域大小为10MB
        ssl_ciphers ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-ECDSA-CHACHA20-POLY1305;
        ssl_session_timeout 10m;                        # SSL TCP会话缓存超时时间为10分钟
        proxy_protocol    on; # 开启proxy_protocol获取真实ip
        proxy_pass        127.0.0.1:38080;
    }
    server {
        listen 80;
        proxy_protocol  on;
        proxy_pass      127.0.0.1:38080;
            }
    server {
        listen              48002 ssl;      # US 圣何塞 | AMD

        ssl_protocols      TLSv1.2 TLSv1.3;      # 设置使用的SSL协议版本

        ssl_certificate /etc/nginx/cert/bpg-nd-cc-ora-6899.spdio.xyz/fullchain.pem; # 证书地址
        ssl_certificate_key /etc/nginx/cert/bpg-nd-cc-ora-6899.spdio.xyz/key.key; # 秘钥地址
        ssl_session_cache   shared:SSL:10m;             # SSL TCP会话缓存设置共享内存区域名为
                                                        # SSL，区域大小为10MB
        ssl_ciphers ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-ECDSA-CHACHA20-POLY1305;
        ssl_session_timeout 10m;                        # SSL TCP会话缓存超时时间为10分钟
        proxy_protocol    on; # 开启proxy_protocol获取真实ip
        proxy_pass        127.0.0.1:38081;
    }
    #stream-add
}
http {
        sendfile on;
        tcp_nopush on;
        tcp_nodelay on;
        keepalive_timeout 65;
        types_hash_max_size 2048;
        include /etc/nginx/mime.types;
        default_type application/octet-stream;
        ssl_protocols TLSv1.2 TLSv1.3; # Dropping SSLv3, ref: POODLE
        ssl_prefer_server_ciphers on;
        gzip on;
        include /etc/nginx/conf.d/*.conf;
        include /etc/nginx/sites-enabled/*;
}